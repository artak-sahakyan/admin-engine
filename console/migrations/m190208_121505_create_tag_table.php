<?php

use yii\db\Migration;

/**
 * Handles the creation of table `{{%tag}}`.
 */
class m190208_121505_create_tag_table extends Migration
{
    /**
     * {@inheritdoc}
     */
    public function safeUp()
    {
        $this->createTable('{{%tags}}', [
            'id'                => $this->primaryKey(),
            'title'             => $this->string(),
            'alias'             => $this->string(),
            'keywords'          => $this->string(),
            'description'       => $this->text(),
            'h1'                => $this->string(),
            'meta_description'  => $this->text()
        ], 'CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE=InnoDB');

        Yii::$app->db->createCommand(
            'INSERT INTO `tags` (`id`, `title`, `alias`, `keywords`, `description`, `h1`, `meta_description`) VALUES
                (2, \'Грибок ногтей\', \'gribok-nogtej\', \'грибок ногтей\', \'Как вылечить грибок ногтей\', \'Грибок ногтей\', \'Статьи на тему лечения грибка ногтей\'),
                (3, \'паразиты\', \'parazity\', \'паразиты\', \'Паразиты в организме человека, как обнаружить и как с ними бороться\', NULL, NULL),
                (4, \'простуда\', \'prostuda\', \'простуда\', \'простуда\', NULL, NULL),
                (5, \'потенция\', \'potenciya\', \'потенция\', \'Лечение проблем с потенцией\', \'Потенция\', \'Статьи на тему лечение проблем с потенцией\')'
        )->execute();

        // create tag_vs_article table with data
        Yii::$app->db->createCommand(
            'CREATE TABLE `tag_vs_articles` (
              `tag_id` int(10) UNSIGNED NOT NULL COMMENT \'ID тега\',
              `article_id` int(10) UNSIGNED NOT NULL COMMENT \'ID статьи\'
            ) ENGINE=InnoDB DEFAULT CHARSET=latin1')->execute();

        Yii::$app->db->createCommand( 'INSERT INTO `tag_vs_articles` (`tag_id`, `article_id`) VALUES
                (2, 3176),
                (2, 3464),
                (2, 3534),
                (2, 3535),
                (2, 3536),
                (2, 3537),
                (2, 3585),
                (2, 3589),
                (2, 3690),
                (2, 4785),
                (2, 5201),
                (2, 5256),
                (2, 5392),
                (2, 5403),
                (2, 5407),
                (2, 5525),
                (2, 5625),
                (2, 5633),
                (2, 5650),
                (2, 6614),
                (2, 7086),
                (2, 7103),
                (2, 7117),
                (2, 7128),
                (2, 7142),
                (2, 7146),
                (2, 7152),
                (2, 7153),
                (2, 7160),
                (2, 7161),
                (2, 7164),
                (2, 7177),
                (2, 7185),
                (2, 7208),
                (2, 7223),
                (2, 7646),
                (2, 14094),
                (2, 14129),
                (2, 14131),
                (2, 14133),
                (2, 14154),
                (2, 14181),
                (2, 14188),
                (2, 14192),
                (2, 14260),
                (2, 14305),
                (2, 14324),
                (2, 14334),
                (2, 14335),
                (2, 14379),
                (2, 14382),
                (2, 14391),
                (2, 14392),
                (2, 14403),
                (2, 14421),
                (2, 14425),
                (2, 14436),
                (2, 14441),
                (2, 14442),
                (2, 14471),
                (2, 14472),
                (2, 14513),
                (2, 14541),
                (2, 14543),
                (2, 14570),
                (2, 14571),
                (2, 14592),
                (2, 14593),
                (2, 14612),
                (2, 14622),
                (2, 14656),
                (2, 14668),
                (2, 14781),
                (2, 14785),
                (2, 14786),
                (2, 14790),
                (2, 14839),
                (2, 14840),
                (2, 14845),
                (2, 14846),
                (2, 14857),
                (2, 14860),
                (2, 14879),
                (2, 14896),
                (2, 14945),
                (2, 14951),
                (2, 14967),
                (2, 14980),
                (2, 14992),
                (2, 15005),
                (2, 15043),
                (2, 15084),
                (2, 15085),
                (2, 15147),
                (2, 15148),
                (2, 15150),
                (2, 15204),
                (2, 15207),
                (2, 15223),
                (2, 15232),
                (2, 15234),
                (2, 15307),
                (2, 15338),
                (2, 15632),
                (2, 15877),
                (2, 15912),
                (2, 15914),
                (2, 15925),
                (2, 15927),
                (2, 15986),
                (2, 15989),
                (2, 16043),
                (2, 16114),
                (2, 16116),
                (2, 16118),
                (2, 16195),
                (2, 16278),
                (2, 16335),
                (2, 16431),
                (2, 16439),
                (2, 16444),
                (2, 16535),
                (2, 16640),
                (2, 16651),
                (2, 16720),
                (2, 16862),
                (2, 17173),
                (2, 17174),
                (2, 17175),
                (2, 17176),
                (2, 17177),
                (2, 17232),
                (2, 17418),
                (2, 17477),
                (2, 17478),
                (2, 17479),
                (2, 17480),
                (2, 17669),
                (2, 17797),
                (2, 17914),
                (2, 18793),
                (2, 19067),
                (2, 19068),
                (2, 19137),
                (2, 19468),
                (2, 19527),
                (2, 19543),
                (2, 19552),
                (2, 19558),
                (2, 19560),
                (2, 19564),
                (2, 19566),
                (2, 19594),
                (3, 4888),
                (3, 5291),
                (3, 5319),
                (3, 5321),
                (3, 5361),
                (3, 5417),
                (3, 5660),
                (3, 5784),
                (3, 5796),
                (3, 7157),
                (3, 7636),
                (3, 7643),
                (3, 8707),
                (3, 9824),
                (3, 10092),
                (3, 10596),
                (3, 10643),
                (3, 10804),
                (3, 10814),
                (3, 10862),
                (3, 10873),
                (3, 10882),
                (3, 10978),
                (3, 10992),
                (3, 11009),
                (3, 11156),
                (3, 11254),
                (3, 11310),
                (3, 11314),
                (3, 11478),
                (3, 11513),
                (3, 11753),
                (3, 11809),
                (3, 11874),
                (3, 12120),
                (3, 12474),
                (3, 13992),
                (3, 15624),
                (3, 15663),
                (3, 15665),
                (3, 15787),
                (3, 17143),
                (3, 17200),
                (3, 17223),
                (3, 17224),
                (3, 17226),
                (3, 17227),
                (3, 17758),
                (3, 17810),
                (3, 18180),
                (3, 19344),
                (3, 20044),
                (4, 3216),
                (4, 4285),
                (4, 4613),
                (4, 5264),
                (4, 5292),
                (4, 5413),
                (4, 5561),
                (4, 5829),
                (4, 6989),
                (4, 8398),
                (4, 10351),
                (4, 12972),
                (4, 13068),
                (4, 14603),
                (4, 14681),
                (4, 14747),
                (4, 14777),
                (4, 14834),
                (4, 14937),
                (4, 14990),
                (4, 16053),
                (4, 16233),
                (4, 16292),
                (4, 17318),
                (4, 20777),
                (5, 6605),
                (5, 11037),
                (5, 11047),
                (5, 11432),
                (5, 11444),
                (5, 11504),
                (5, 11522),
                (5, 11559),
                (5, 11565),
                (5, 11574),
                (5, 11791),
                (5, 11792),
                (5, 11795),
                (5, 11797),
                (5, 11801),
                (5, 11824),
                (5, 11846),
                (5, 11848),
                (5, 11898),
                (5, 11912),
                (5, 11913),
                (5, 11919),
                (5, 11921),
                (5, 11924),
                (5, 11938),
                (5, 11962),
                (5, 11973),
                (5, 11981),
                (5, 11988),
                (5, 12002),
                (5, 12006),
                (5, 12012),
                (5, 12015),
                (5, 12019),
                (5, 12096),
                (5, 12159),
                (5, 12168),
                (5, 12173),
                (5, 12188),
                (5, 12230),
                (5, 12234),
                (5, 12339),
                (5, 13348),
                (5, 14130),
                (5, 14132),
                (5, 14156),
                (5, 14350),
                (5, 14567),
                (5, 14886),
                (5, 14915),
                (5, 14941),
                (5, 15276),
                (5, 15371),
                (5, 15381),
                (5, 15406),
                (5, 15463),
                (5, 15473),
                (5, 16021),
                (5, 16117),
                (5, 16242),
                (5, 16288),
                (5, 16322),
                (5, 16325),
                (5, 16327),
                (5, 16442),
                (5, 16703),
                (5, 16746),
                (5, 16987),
                (5, 17115),
                (5, 17236),
                (5, 17243),
                (5, 17483),
                (5, 17484),
                (5, 17487),
                (5, 17488),
                (5, 17489),
                (5, 17490),
                (5, 17491),
                (5, 17493),
                (5, 17495),
                (5, 17496),
                (5, 17497),
                (5, 17498),
                (5, 17499),
                (5, 17502),
                (5, 17757),
                (5, 17860),
                (5, 17897),
                (5, 18047),
                (5, 18085),
                (5, 18417),
                (5, 18438),
                (5, 19346)')->execute();
        Yii::$app->db->createCommand( 'ALTER TABLE `tag_vs_articles` ADD PRIMARY KEY (`tag_id`,`article_id`)')->execute();

        // create tag_vs_article_category table
        Yii::$app->db->createCommand(
            'CREATE TABLE `tag_vs_article_categories` (
              `tag_id` int(10) UNSIGNED NOT NULL COMMENT \'ID тега\',
              `category_id` int(10) UNSIGNED NOT NULL COMMENT \'ID категории\'
        ) ENGINE=InnoDB DEFAULT CHARSET=latin1')->execute();

        Yii::$app->db->createCommand('INSERT INTO `tag_vs_article_categories` (`tag_id`, `category_id`) VALUES (2, 45)');

        Yii::$app->db->createCommand('ALTER TABLE `tag_vs_article_categories` ADD PRIMARY KEY (`tag_id`,`category_id`)');
    }

    /**
     * {@inheritdoc}
     */
    public function safeDown()
    {
        $this->dropTable('{{%tags}}');
        $this->dropTable('{{%tag_vs_articles}}');
        $this->dropTable('{{%tag_vs_article_categories}}');
    }
}
